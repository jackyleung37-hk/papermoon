import { useState } from "react";
import { Select, SelectTrigger, SelectContent, SelectItem } from "@/components/ui/select";
import { Checkbox } from "@/components/ui/checkbox";
import { Button } from "@/components/ui/button";

export default function FilterBar({ onFilterChange }) {
  const [filters, setFilters] = useState({
    month: "",
    sunset: "",
    difficulty: "",
    tags: [],
  });

  const handleSelect = (key, value) => {
    setFilters(prev => ({ ...prev, [key]: value }));
    onFilterChange?.({ ...filters, [key]: value });
  };

  const handleTagToggle = (tag) => {
    setFilters(prev => {
      const newTags = prev.tags.includes(tag)
        ? prev.tags.filter(t => t !== tag)
        : [...prev.tags, tag];
      onFilterChange?.({ ...filters, tags: newTags });
      return { ...prev, tags: newTags };
    });
  };

  return (
    <div className="flex flex-wrap gap-4 bg-white p-4 rounded-2xl shadow-sm mb-6">
      <Select onValueChange={v => handleSelect("month", v)}>
        <SelectTrigger className="w-[150px]">月份</SelectTrigger>
        <SelectContent>
          <SelectItem value="1月">1月</SelectItem>
          <SelectItem value="2月">2月</SelectItem>
          <SelectItem value="3月">3月</SelectItem>
          <SelectItem value="4月">4月</SelectItem>
          {/* 可自行加更多月份 */}
        </SelectContent>
      </Select>

      <Select onValueChange={v => handleSelect("sunset", v)}>
        <SelectTrigger className="w-[150px]">日落</SelectTrigger>
        <SelectContent>
          <SelectItem value="海邊">海邊</SelectItem>
          <SelectItem value="山上">山上</SelectItem>
          <SelectItem value="城市">城市</SelectItem>
        </SelectContent>
      </Select>

      <Select onValueChange={v => handleSelect("difficulty", v)}>
        <SelectTrigger className="w-[150px]">難度</SelectTrigger>
        <SelectContent>
          <SelectItem value="易">易</SelectItem>
          <SelectItem value="中">中</SelectItem>
          <SelectItem value="難">難</SelectItem>
        </SelectContent>
      </Select>

      <div className="flex items-center gap-3">
        {["浪漫", "自然", "親子", "打卡"].map(tag => (
          <label key={tag} className="flex items-center gap-1">
            <Checkbox
              checked={filters.tags.includes(tag)}
              onCheckedChange={() => handleTagToggle(tag)}
            />
            <span>{tag}</span>
          </label>
        ))}
      </div>

      <Button variant="outline" onClick={() => setFilters({ month: "", sunset: "", difficulty: "", tags: [] })}>
        清除
      </Button>
    </div>
  );
}
